{"version":3,"sources":["webpack://mini-video-me/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://mini-video-me/./src/config.ts","webpack://mini-video-me/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://mini-video-me/./src/cam.ts","webpack://mini-video-me/./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack://mini-video-me/./src/index.ts"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","userPreferences","window","MiniVideoMe","config","width","Number","camera","height","frameRate","flipHorizontal","Boolean","rounded","scale","zoom","horizontal","anchor","x","vertical","y","_defineProperties","target","props","i","length","descriptor","CameraController","instance","Constructor","TypeError","this","videoWrapper","document","getElementById","videoElement","isFlipped","isRounded","position","z","render","protoProps","type","transform","classList","push","style","join","className","prototype","videoDevices","cameraController","navigator","mediaDevices","enumerateDevices","then","devices","filter","device","kind","getUserMedia","video","deviceId","stream","srcObject","availableDevices","map","id","label","sendVideoInputDevices","mouseHideTimeout","controls","adjustOffset","round","addEventListener","event","on","ondblclick","sendDoubleClick","body","cursor","clearTimeout","setTimeout"],"mappings":"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","file":"main_window/index.js","sourcesContent":["export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","const userPreferences = window.MiniVideoMe.config\n\nconst config = {\n  width: Number(userPreferences.camera.width),\n  height: Number(userPreferences.camera.height),\n  frameRate: Number(userPreferences.camera.frameRate),\n  flipHorizontal: Boolean(userPreferences.flipHorizontal),\n  rounded: Boolean(userPreferences.rounded),\n  scale: Number(userPreferences.zoom ?? 1),\n  horizontal: Number(userPreferences.anchor.x ?? 0),\n  vertical: Number(userPreferences.anchor.y ?? 0)\n}\n\nexport { config }\n","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","import { config } from './config'\n\ntype MovePosition = 'left' | 'right' | 'up' | 'down'\n\ntype ZoomType = 'in' | 'out'\n\nexport class CameraController {\n  public videoElement: HTMLVideoElement\n\n  private videoWrapper: HTMLDivElement\n  private isFlipped: boolean\n  private isRounded: boolean\n  private position: Record<'x' | 'y' | 'z', number>\n\n  constructor() {\n    this.videoWrapper = document.getElementById('wrapper') as HTMLDivElement\n    this.videoElement = document.getElementById('video') as HTMLVideoElement\n\n    this.isFlipped = config.flipHorizontal\n    this.isRounded = config.rounded\n\n    this.position = {\n      x: config.horizontal,\n      y: config.vertical,\n      z: config.scale\n    }\n\n    this.render()\n  }\n\n  public flipHorizontal() {\n    this.isFlipped = !this.isFlipped\n\n    this.render()\n  }\n\n  public adjustOffset(position: MovePosition) {\n    switch (position) {\n      case 'up':\n        this.position.y -= 1\n        break\n      case 'down':\n        this.position.y += 1\n        break\n      case 'left':\n        this.position.x -= 1\n        break\n      case 'right':\n        this.position.x += 1\n        break\n    }\n\n    this.render()\n  }\n\n  public zoom(type: ZoomType) {\n    if (type === 'in') {\n      this.position.z += 0.1\n    } else {\n      this.position.z -= 0.1\n    }\n\n    this.render()\n  }\n\n  public round() {\n    this.isRounded = !this.isRounded\n\n    this.render()\n  }\n\n  private render() {\n    let transform: string[] = []\n    let classList: string[] = []\n\n    transform.push(`translate(${this.position.x}%, ${this.position.y}%)`)\n    transform.push(`scale(${this.position.z})`)\n\n    if (this.isFlipped) {\n      classList.push('flip')\n      transform.push('rotateY(180deg)')\n    }\n\n    this.videoElement.style.transform = transform.join(' ')\n    this.videoElement.className = classList.join(' ')\n    this.videoWrapper.className = this.isRounded ? 'rounded' : ''\n  }\n}\n","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","import { config } from './config'\nimport { CameraController } from './cam'\n\nconst { MiniVideoMe } = window\n\nconst cameraController = new CameraController()\n\nlet videoDevices: MediaDeviceInfo[]\n\nnavigator.mediaDevices.enumerateDevices().then((devices) => {\n  videoDevices = devices.filter((device) => {\n    return device.kind === 'videoinput';\n  });\n\n  navigator.mediaDevices.getUserMedia({\n    video: {...config, deviceId: videoDevices[0].deviceId } || true\n  }).then(stream => {\n    cameraController.videoElement.srcObject = stream\n  })\n\n  const availableDevices = videoDevices.map((device) => {\n    return {\n      id: device.deviceId,\n      label: device.label,\n    }\n  })\n\n  MiniVideoMe.sendVideoInputDevices(availableDevices)\n}) \n \nconst controls: Record<string, () => void> = {\n  'ArrowLeft': () => cameraController.adjustOffset('left'),\n  'ArrowRight': () => cameraController.adjustOffset('right'),\n  'ArrowUp': () => cameraController.adjustOffset('up'),\n  'ArrowDown': () => cameraController.adjustOffset('down'),\n  '=': () => cameraController.zoom('in'),\n  '-': () => cameraController.zoom('out'),\n  '/': () => cameraController.flipHorizontal(),\n  'o': () => cameraController.round()\n}\n\nwindow.addEventListener('keydown', (event) => {\n  if (controls[event.key]) {\n    controls[event.key]()\n  }\n})\n\nMiniVideoMe.on('videoInputChange', (deviceId: string) => {\n  navigator.mediaDevices\n    .getUserMedia({ video: { ...config, deviceId } || true })\n    .then((stream) => (cameraController.videoElement.srcObject = stream));\n})\n\n/* Mac Only: Change Size */\nwindow.ondblclick = changeWrapperSize\n\nfunction changeWrapperSize () {\n  MiniVideoMe.sendDoubleClick()\n}\n/* End Mac Only */\n\n/* tested only on Mac */\nlet mouseHideTimeout: NodeJS.Timeout;\n\nwindow.addEventListener('mousemove', () => {\n  document.body.style.cursor = 'default'\n\n  clearTimeout(mouseHideTimeout)\n\n  mouseHideTimeout = setTimeout(() => {\n    document.body.style.cursor = 'none'\n  }, 1000)\n})\n/* end tested only on Mac */\n"],"sourceRoot":""}